// Generated by CoffeeScript 1.11.1
var misc;

module.exports = function(options, callback) {
  var cmd_delprinc, cmd_getprinc;
  if (!options.principal) {
    return callback(new Error('Property principal is required'));
  }
  if (/.*@.*/.test(options.kadmin_principal)) {
    if (options.realm == null) {
      options.realm = options.kadmin_principal.split('@')[1];
    }
  }
  if (!/^\S+@\S+$/.test(options.principal)) {
    options.principal = options.principal + "@" + options.realm;
  }
  cmd_getprinc = misc.kadmin(options, "getprinc " + options.principal);
  cmd_delprinc = misc.kadmin(options, "delprinc -force " + options.principal);
  this.execute({
    cmd: cmd_delprinc,
    if_exec: cmd_getprinc + " | grep '" + options.principal + "'"
  });
  this.remove({
    target: options.keytab,
    "if": options.keytab
  });
  return this.then(callback);
};

misc = require('../misc');
