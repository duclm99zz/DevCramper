// Generated by CoffeeScript 1.11.1
var each, fs, glob, misc;

module.exports = function(options, callback) {
  options.log({
    message: "Entering remove",
    level: 'DEBUG',
    module: 'mecano/lib/remove'
  });
  if (options.argument != null) {
    options.target = options.argument;
  }
  if (options.target == null) {
    options.target = options.source;
  }
  if (options.target == null) {
    return callback(Error("Missing option: \"target\""));
  }
  return glob(options.ssh, options.target, function(err, files) {
    var modified;
    modified = false;
    if (err) {
      return callback(err);
    }
    return each(files).call(function(file, callback) {
      modified = true;
      return misc.file.remove(options.ssh, file, callback);
    }).then(function(err) {
      return callback(err, modified);
    });
  });
};

fs = require('ssh2-fs');

each = require('each');

misc = require('../misc');

glob = require('../misc/glob');
